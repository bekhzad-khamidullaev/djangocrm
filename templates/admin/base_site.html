{% extends "admin/base.html" %}{% load static i18n %}

{% block extrahead %}{{ block.super }}
  {# removed COMM_DEFAULTS sip auto-fill #}
  <script>
    window.COMM_DEFAULTS = undefined;
      sms_channel_id: {{ comm_sms_channel_id|default:'null' }},
      sms_channel_name: {{ comm_sms_channel_name|default:'null' }},
      enable_sms: {{ comm_enable_sms|yesno:'true,false' }},
      enable_telegram: {{ comm_enable_telegram|yesno:'true,false' }},
      enable_instagram: {{ comm_enable_instagram|yesno:'true,false' }},
      enable_call: {{ comm_enable_call|yesno:'true,false' }},
      // SIP defaults from user profile if available
      sip_uri: {{ request.user.profile.jssip_sip_uri|default:'null'|safe }},
      sip_display: {{ request.user.profile.jssip_display_name|default:'null'|safe }},
      sip_password: {{ request.user.profile.jssip_sip_password|default:'null'|safe }}
    };
  </script>
  {# modern_admin.js temporarily disabled (404). Re-enable when available in static. #}
  {# <script src="{% static 'admin/js/modern_admin.js' %}" defer></script> #}
{% endblock %}

{% block title %}
    {% if subtitle %}{{ subtitle }} | {% endif %}
    {# CRM: add prefix "A:"  for admin page title #}
    {% if "admin" in request.META.PATH_INFO %}A: {% endif %}
    {{ title }} | {{ site_title }}
{% endblock %}

{% block branding %}
<div id="site-name"><a href="{% url 'admin:index' %}">
    {# CRM: add Django-CRM Logo #}
    <img src="{% static 'common/django-crm_logo_24px.svg' %}" alt="Django-CRM Logo" style="vertical-align: sub;"> {{ site_header }}</a>
</div>
{% if user.is_anonymous %}
  {% include "admin/color_theme_toggle.html" %}
{% endif %}
{% endblock %}

{% block nav-global %}{% endblock %}
